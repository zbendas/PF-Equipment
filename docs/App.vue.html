<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: App.vue</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: App.vue</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>&lt;template>
    &lt;div class="app-body">
        &lt;form @submit.prevent>
            &lt;div class="search search-container">
                &lt;input class="search search-box" type="text" title="Search" aria-label="Search"
                       placeholder="Search by typing here, e.g.: dagger, gauntlet, longspear"
                       v-model="search_text"
                       v-on:focus="collapseAll"
                />
                &lt;div class="search clear-button" v-on:click="search_text = ''">
                    &lt;img src="./assets/icons/closed.svg"
                         @dragstart.prevent
                         aria-label="Clear search field"
                         title="Clear"
                    />
                &lt;/div>
            &lt;/div>
        &lt;/form>
        &lt;search-settings
                v-bind:categories="categories"
                v-on:apply-filter="setFilter"
                v-on:clear-filters="clearFilter"
                v-on:reset-complete="clearResetFlags"

        />
        &lt;equipment-result
                v-for="item in items" :key="item.name"
                v-bind:item="item"
                v-bind:search_text="search_text"
                v-bind:is_result="isResult(item)"
                v-bind:current_filter="current_filter"
                v-bind:expanded="expanded_equipment[item.name]"
                v-bind:filtered="isFiltered(item, current_filter)"
                v-on:expand-equipment="(key) => { expanded_equipment[key] = !expanded_equipment[key] }"
        />
        &lt;div class="no-results"
             v-show="!resultsAvailable()"
        >
            No results found.
        &lt;/div>
    &lt;/div>
&lt;/template>

&lt;!--suppress JSUnusedGlobalSymbols -->
&lt;script>
    /**
     * @module App
     */
    /**
     * An object which describes and contains parameters relating to a filter category
     * @typedef {Object} CategoryObject
     * @property {string} category_name - The human-readable name of the category.
     * @property {string} category_key - The machine-readable name of the category. Should be kept lowercase.
     * @property {string[]} category_items - String array representing the individual filterable choices in a category.
     * @property {boolean} reset - Flag denoting that the SearchCategory component for this item needs to be reset.
     * If true, reset has yet to occur. If false, reset has occurred.
     */
    import EquipmentResult from "./components/EquipmentResult.vue";
    import SearchSettings from "./components/SearchSettings.vue";
    import ItemDataSet from "./assets/item_data.js";
    import equipmentCompare from "./assets/EquipmentCompare.js";

    export default {
        name: "app",
        components: {
            SearchSettings,
            EquipmentResult,
        },
        /**
         * @desc Vue component property used to provide pre-computed data mounted on the component.
         */
        computed: {
            classification_categories: function () {
                /**
                 * @function classification_categories
                 * @desc Returns an array of [CategoryObjects]{@link CategoryObject} that are dynamically generated by this function, based on the
                 * information available about currently-loaded item data.
                 * @return {CategoryObject[]}
                 * @instance
                 */
                let classification_array = [];
                this.items.forEach((value) => {
                    if (value.hasOwnProperty("classification")) {
                        classification_array.push(value.classification);
                    }
                });
                classification_array = classification_array.filter((item, index) => {
                    return classification_array.indexOf(item) === index;
                });
                return classification_array.sort().reverse();
            },
            categories_func: function () {
                /**
                 * @function categories_func
                 * @desc Returns an array of [CategoryObjects]{@link CategoryObject} that contain information
                 * necessary to generate [SearchSettings]{@link module:SearchSettings} and [SearchCategory]{@link module:SearchCategory} components.
                 * @return {CategoryObject[]}
                 * @instance
                 */
                return [
                    {
                        "category_name": "Classification",
                        "category_key": "classification",
                        "category_items": this.classification_categories,
                        "reset": false
                    },
                    {
                        "category_name": "Item Type",
                        "category_key": "item_type",
                        "category_items": this.item_categories,
                        "reset": false
                    },
                    {
                        "category_name": "Damage Type",
                        "category_key": "damage_type",
                        "category_items": this.damage_categories,
                        "reset": false
                    },
                    {
                        "category_name": "Range (â‰¥)",
                        "category_key": "range",
                        "category_items": this.range_categories,
                        "additional_label": "ft.",
                        "reset": false
                    }
                ];
            },
            //TODO: Consider refactoring these functions into a single function that copies itself into three separate manager arrays
            expanded_equipment_func: function () {
                /**
                 * @function expanded_equipment_func
                 * @desc Creates manager array for the expanded property on child [EquipmentResult]{@link module:EquipmentResult} components.
                 * @return {Object&lt;string, boolean>}
                 * @instance
                 */
                let equipment_out = {};
                this.items.forEach((value) => {
                    equipment_out[value.name] = false;
                });
                return equipment_out;
            },
            filtered_equipment_func: function () {
                /**
                 * @function filtered_equipment_func
                 * @desc Creates manager array for the filtered property on child [EquipmentResult]{@link module:EquipmentResult} components.
                 * @return {Object&lt;string, boolean>}
                 * @instance
                 */
                let equipment_out = {};
                this.items.forEach((value) => {
                    equipment_out[value.name] = false;
                });
                return equipment_out;
            },
            result_equipment_func: function () {
                /**
                 * @function result_equipment_func
                 * @desc Creates manager array for the is_result property on child [EquipmentResult]{@link module:EquipmentResult} components.
                 * @return {Object&lt;string, boolean>}
                 * @instance
                 */
                let equipment_out = {};
                this.items.forEach((value) => {
                    equipment_out[value.name] = false;
                });
                return equipment_out;
            },
            item_categories: function () {
                /**
                 * @function item_categories
                 * @desc Generates an array of unique categories based on the {@link items} array of [ItemObjects]{@link ItemObject}.
                 * @return {string[]}
                 * @instance
                 */
                let item_array = [];
                this.items.forEach((value) => {
                    item_array.push(value.item_type);
                });
                item_array = item_array.filter((item, index) => {
                    return item_array.indexOf(item) === index;
                });
                return item_array;
            }
        },
        created: function () {
            // After creation, both computed values and data values become available, so we can re-assign
            // the data version of expanded_equipment to be equal to the dynamically computed object
            this.expanded_equipment = this.expanded_equipment_func;
            this.filtered_equipment = this.filtered_equipment_func;
            this.result_equipment = this.result_equipment_func;
            this.categories = this.categories_func;
        },
        /**
         * @desc Vue component property used to provide read-write data mounted on the component.
         */
        data: function () {
            return {
                categories: [],
                /**
                 * @type {Object&lt;string, string[]>}
                 * @desc Object containing the currently checked values of the checkboxes found in
                 * {@link SearchCategory} components.
                 * @instance
                 */
                current_filter: {
                    "classification": [],
                    "item_type": [],
                    "damage_type": [],
                    "range": []
                },
                /**
                 * @type {string[]}
                 * @desc Array containing the various damage categories.
                 * @instance
                 */
                damage_categories: [
                    "B",
                    "P",
                    "S",
                ],
                /**
                 * @type {Object&lt;string, boolean>}
                 * @desc Manager array used to determine whether or not a specific [EquipmentResult]{@link module:EquipmentResult} should be rendered as expanded.
                 * @instance
                 */
                expanded_equipment: {},
                /**
                 * @type {Object&lt;string, boolean>}
                 * @desc Manager array used to determine whether or not a specific [EquipmentResult]{@link module:EquipmentResult} passes through the {@link current_filter}.
                 * @instance
                 */
                filtered_equipment: {},
                /**
                 * @type {Object&lt;string, boolean>}
                 * @desc Manager array used to dictate whether or not a specific [EquipmentResult]{@link module:EquipmentResult} matches the {@link search_text} variable.
                 * @instance
                 */
                result_equipment: {},
                /**
                 * @type {ItemObject[]}
                 * @desc Array containing the information for every item in the application.
                 * @instance
                 */
                items: ItemDataSet.sort(equipmentCompare),
                /**
                 * @type {number[]}
                 * @desc Enumerated range values to be used when generating [SearchCategory]{@link module:SearchCategory} components.
                 * @instance
                 */
                range_categories: [
                    10, 20, 30, 40, 50, 100
                ],
                /**
                 * @type {string}
                 * @desc User-entered text used to search for item(s).
                 * @instance
                 */
                search_text: ""
            }
        },
        methods: {
            resultsAvailable: function () {
                /**
                 * @function resultsAvailable
                 * @desc Iterates through the all items, via the result_equipment array, to determine whether or not
                 * they should be displayed based on the current filter and the search_text, via their respective
                 * object-management arrays.
                 * @return {boolean} Returns true if there is an [EquipmentResult]{@link module:EquipmentResult} component that should be displayed.
                 */
                for (let item in this.result_equipment) {
                    if (this.result_equipment[item] &amp;&amp; this.filtered_equipment[item]) {
                        return true;
                    }
                }
                return false;
            },
            clearFilter: function () {
                /**
                 * @function clearFilter
                 * @desc Resets the current_filter, then trips the reset flag for each category, to reset the checkboxes on
                 * children components in [SearchSettings]{@link module:SearchSettings} and [SearchCategory]{@link module:SearchCategory}
                 */
                for (let key in this.current_filter) {
                    this.current_filter[key] = [];
                }
                for (let index in this.categories) {
                    this.categories[index]["reset"] = true;
                }
            },
            clearResetFlags: function (category_key) {
                /**
                 * @function clearResetFlags
                 * @desc Removes the reset flag on the given category, to signify that the checkboxes have been unchecked
                 * within the view model.
                 * @param {string} category_key - The category that has completed the reset process and will have its checkboxes unchecked.
                 */
                for (let index in this.categories) {
                    if (this.categories[index]["category_key"] === category_key) {
                        this.categories[index]["reset"] = false;
                    }
                }
            },
            collapseAll: function () {
                /**
                 * @function collapseAll
                 * @description Resets all expanded_equipment values to false, thereby collapsing all
                 * [EquipmentResult]{@link module:EquipmentResult} components
                 */
                for (let key in this.expanded_equipment) {
                    // noinspection JSUnfilteredForInLoop
                    this.expanded_equipment[key] = false;
                }
            },
            isFiltered: function (item, current_filter) {
                /**
                 * @function isFiltered
                 * @description Determines whether or not an item is supposed to be visible, based on the current_filter.
                 * Also in-place modifies the appropriate boolean value in the filtered_equipment array.
                 * @param {ItemObject} item - Item to check
                 * @param {*} current_filter - Current filter set in the SearchSettings component
                 * @return {boolean} Returns true if the filter is selecting for the passed-in item; i.e., true if the
                 * item/[EquipmentResult]{@link module:EquipmentResult} component should be visible
                 */
                let classification_flag = false, item_type_flag = false, damage_type_flag = false, range_flag = false;
                if (current_filter["classification"].includes(item.classification) || current_filter["classification"].length === 0 || item.item_type === "Ammunition") {
                    classification_flag = true;
                }
                if (current_filter["item_type"].includes(item.item_type) || current_filter["item_type"].length === 0) {
                    item_type_flag = true;
                }
                if (current_filter["damage_type"].length === 0) {
                    damage_type_flag = true;
                }
                else {
                    current_filter["damage_type"].forEach((value) => {
                        if (item.hasOwnProperty("damage_type")) {
                            if (item.damage_type.includes(value)) {
                                damage_type_flag = true;
                            }
                        }
                    });
                }
                if (current_filter["range"].length === 0) {
                    range_flag = true;
                }
                else {
                    current_filter["range"].forEach((value) => {
                        if (item.hasOwnProperty("range")) {
                            if (item.range >= value) {
                                range_flag = true;
                            }
                        }
                    });
                }
                this.filtered_equipment[item.name] = classification_flag &amp;&amp; item_type_flag &amp;&amp; damage_type_flag &amp;&amp; range_flag;
                return this.filtered_equipment[item.name];
            },

            setFilter: function (category_key, checkedItems) {
                /**
                 * @function setFilter
                 * @desc For a given category, set the filter for that category to the array of checked values passed in.
                 * @param {string} category_key - The name of the category to be in-place modified in current_filter
                 * @param {string[]} checkedItems - The array of checked values for this category
                 * @return None
                 */
                this.current_filter[category_key] = checkedItems;
            },
            isResult: function (item) {
                /**
                 * @desc Determines whether or not a given item matches the search_text variable, based on regex comparisons
                 * to both its name and, if applicable, alt_name properties. It then in-place modifies the result_equipment
                 * object that is used to manage the visibility of individual [EquipmentResult]{@link module:EquipmentResult} components. The boolean result
                 * of this comparison is then returned.
                 * @function isResult
                 * @param {ItemObject} item - Specific item to compare to the global search_text
                 * @returns {boolean} Returns the value of the result_equipment object at key: item.name
                 */
                let re = new RegExp(this.search_text, 'gi');
                if (item.hasOwnProperty('alt_name')) {
                    this.result_equipment[item.name] = (re.test(item.name) || re.test(item.alt_name));
                    return this.result_equipment[item.name];
                }
                else {
                    this.result_equipment[item.name] = re.test(item.name);
                    return this.result_equipment[item.name];
                }
            },
        }
    };
&lt;/script>

&lt;style lang="sass">
    @import url('https://fonts.googleapis.com/css?family=Lato:400,700|Montserrat:500')
    @import /assets/variables

    \:root
        background-color: $body-background

    body
        height: 100vh
        display: flex
        flex-direction: column
        margin: 0

    #app
        width: 100vw
        height: 100vw

    .app-body
        flex: 1 0 auto
        min-height: 20vh
        background-color: white
        box-shadow: 25px 25px 19px -1px rgba(0, 0, 0, 0.5)
        -webkit-box-shadow: 25px 25px 19px -1px rgba(0, 0, 0, 05)
        -moz-box-shadow: 25px 25px 19px -1px rgba(0, 0, 0, 0.5)
        @media only screen and (max-width: 768px)
            width: 100vw
            margin: 5vh 0
        width: 60vw
        margin: 5vh 20vw

    input:focus
        outline: white auto 5px

    .search
        height: 2em
        background: $search-background
        border: none
        color: $search-text

    .search-container
        display: flex
        flex-flow: row nowrap
        justify-content: space-between
        align-items: center

    .search-box
        width: 95%
        height: 100%
        padding: 0 4px
        &amp;::placeholder
            font-style: italic

    .clear-button
        cursor: pointer
        width: 32px
        img
            height: 24px
            position: relative
            top: 4px
            left: 4px

    .no-results
        text-align: center
        width: 100%
        padding: 2% 0
        font: normal 2em 'Montserrat', sans-serif

    .icon-attribution
        color: white
        font-size: 0.75em
        opacity: 0.5
        flex-shrink: 0
        a
            text-decoration: none
            color: darken(white, 50%)
&lt;/style>
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-App.html">App</a></li><li><a href="module-EquipmentDetail.html">EquipmentDetail</a></li><li><a href="module-EquipmentIcon.html">EquipmentIcon</a></li><li><a href="module-EquipmentResult.html">EquipmentResult</a></li><li><a href="module-ItemData.html">ItemData</a></li><li><a href="module-SearchCategory.html">SearchCategory</a></li><li><a href="module-SearchSettings.html">SearchSettings</a></li></ul><h3>Events</h3><ul><li><a href="module-EquipmentResult.html#event:expand-equipment">expand-equipment</a></li><li><a href="module-SearchCategory.html#event:prepared-filter">prepared-filter</a></li><li><a href="module-SearchCategory.html#event:reset-complete">reset-complete</a></li><li><a href="module-SearchSettings.html#event:apply-filter">apply-filter</a></li><li><a href="module-SearchSettings.html#event:reset-complete">reset-complete</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Fri May 25 2018 08:27:35 GMT-0500 (Central Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
